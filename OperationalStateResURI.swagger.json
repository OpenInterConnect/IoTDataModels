{
  "swagger": "2.0",
  "info": {
    "title": "Operational State",
    "version": "2019-02-15",
    "license": {
      "name": "OCF Data Model License",
      "url": "https://github.com/openconnectivityfoundation/core/blob/e28a9e0a92e17042ba3e83661e4c0fbce8bdc4ba/LICENSE.md",
      "x-copyright": "copyright 2016-2017, 2019 Open Connectivity Foundation, Inc. All rights reserved."
    },
    "termsOfService": "https://openconnectivityfoundation.github.io/core/DISCLAIMER.md"
  },
  "schemes": ["http"],
  "consumes": ["application/json"],
  "produces": ["application/json"],
  "paths": {
    "/OperationalStateResURI": {
      "get": {
        "description": "This Resource describes the operational and job states on a device.\nThe states can be read or set, setting indicates a desired state.\nA device may reject an attempt to set a state that would result\nin adverse operational characteristics.\nThe Property \"machineStates\" is an array of the possible operational states.\nThe Property \"currentMachineState\" is the current state of operation of the device.\nThe Property \"jobStates\" is an array of the possible job states.\nThe Property \"currentJobState\" is the currently active jobState.\nThe Property \"runningTime\" is the ISO8601 encoded elapsed time in the current operational state.\nThe Property \"remainingTime\" is the ISO8601 encoded time till completion of the current operational state.\nThe Property \"progressPercentage\" is the percentage completeness of the current jobState.",
        "parameters": [
          {"$ref": "#/parameters/interface"}
        ],
        "responses": {
          "200": {
            "description" : "RETRIEVES the current operational and job states.",
            "x-example": {
              "rt": ["oic.r.operational.state"],
              "if": ["oic.if.a", "oic.if.baseline"],
              "machineStates": ["pause", "stopped", "idle", "active"],
              "currentMachineState": "active",
              "jobStates": ["preWash", "wash", "rinse", "spin", "dry", "airDry", "wrinklePrevent"],
              "currentJobState": "rinse",
              "runningTime": "PT15M20S",
              "remainingTime": "PT10M40S",
              "progressPercentage": 75
            },
            "schema": { "$ref": "#/definitions/Operation" }
          }
        }
      },
      "post": {
        "description": "Sets the desired operational or job state.",
        "parameters": [
          {"$ref": "#/parameters/interface"},
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": { "$ref": "#/definitions/OperationUpdate" },
            "x-example": {
              "currentMachineState": "pause",
              "currentJobState": "wash"
            }
          }
        ],
        "responses": {
          "200": {
            "description" : "",
            "x-example": {
              "currentMachineState": "pause",
              "currentJobState": "wash"
            },
            "schema": { "$ref": "#/definitions/OperationUpdate" }
          },
          "403": {
            "description" : "This response is generated by the OCF Server when the client sends:\n  An UPDATE with an value for \"currentMachineState\" that is not found in\"machineStates\".\n  An UPDATE with an value for \"currentJobState\" that is not found in \"jobStates\".\nThe OCF Server responds with the current resource representation.\n",
            "x-example": {
              "machineStates": ["pause", "stopped", "idle", "active"],
              "currentMachineState": "active",
              "jobStates": ["preWash", "wash", "rinse", "spin", "dry", "airDry", "wrinklePrevent"],
              "currentJobState": "rinse",
              "runningTime": "PT15M20S",
              "remainingTime": "PT10M40S",
              "progressPercentage": 75
            },
            "schema": { "$ref": "#/definitions/Operation" }
          }
        }
      }
    }
  },
  "parameters": {
    "interface": {
      "in": "query",
      "name": "if",
      "type": "string",
      "enum": ["oic.if.a", "oic.if.baseline"]
    }
  },
  "definitions": {
    "Operation" : {
      "properties": {
        "rt": {
          "description": "The Resource Type.",
          "items": {
            "enum": ["oic.r.operational.state"],
            "maxLength": 64,
            "type": "string"
          },
          "minItems": 1,
          "uniqueItems": true,
          "readOnly": true,
          "type": "array"
        },
        "currentMachineState": {
          "description": "The current state of operation of the device.",
          "type": "string"
        },
        "currentJobState": {
          "description": "The currently active jobState.",
          "type": "string"
        },
        "machineStates": {
          "description": "The array of the possible operational states.",
          "items": {
            "type": "string"
          },
          "readOnly": true,
          "type": "array"
        },
        "runningTime": {
          "$ref": "https://openconnectivityfoundation.github.io/core/schemas/oic.types-schema.json#/definitions/duration"
        },
        "remainingTime": {
          "$ref": "https://openconnectivityfoundation.github.io/core/schemas/oic.types-schema.json#/definitions/duration"
        },
        "progressPercentage": {
          "description": "The percentage completeness of the current jobState.",
          "maximum": 100,
          "minimum": 0,
          "readOnly": true,
          "type": "integer"
        },
        "jobStates": {
          "description": "The Array of the possible job states.",
          "items": {
            "type": "string"
          },
          "readOnly": true,
          "type": "array"
        },
        "n": {
            "$ref": "https://openconnectivityfoundation.github.io/core/schemas/oic.common.properties.core-schema.json#/definitions/n"
        },
        "id": {
            "$ref": "https://openconnectivityfoundation.github.io/core/schemas/oic.common.properties.core-schema.json#/definitions/id"
        },
        "if": {
          "description": "The OCF Interface set supported by this Resource.",
          "items": {
            "enum": [
              "oic.if.a",
              "oic.if.baseline"
            ],
            "type": "string"
          },
          "minItems": 2,
          "uniqueItems": true,
          "readOnly": true,
          "type": "array"
        }
      },
      "type": "object",
      "required": ["machineStates", "currentMachineState"]
    },
    "OperationUpdate" : {
      "properties": {
         "currentMachineState": {
          "description": "The current state of operation of the device.",
          "type": "string"
        },
        "currentJobState": {
          "description": "THe currently active jobState.",
          "type": "string"
        }
      },
      "type": "object"
    }
  }
}
