{
  "swagger":"2.0",
  "info":{
    "title":"ShadowSynchronization",
    "version":"20190402",
    "license":{
      "name":"OCF Data Model License",
      "url":"https://github.com/openconnectivityfoundation/core/blob/e28a9e0a92e17042ba3e83661e4c0fbce8bdc4ba/LICENSE.md",
      "x-copyright":"copyright 2016-2017, 2019 Open Connectivity Foundation, Inc. All rights reserved."
    },
    "termsOfService":"https://openconnectivityfoundation.github.io/core/DISCLAIMER.md"
  },
  "schemes":[
    "http"
  ],
  "consumes":[
    "application/json"
  ],
  "produces":[
    "application/json"
  ],
  "paths":{
    "/ShadowSynchronizationResURI":{
      "get":{
        "description":"This Resource serves as the receiving end of synchronization requests from the Original Device or the Shadow Device.",
        "parameters":[
          {
            "$ref":"#/parameters/interface"
          }
        ],
        "responses":{
          "200":{
            "description":"Retrieves the baseline properties of the Shadow Synchronization Resource.",
            "x-example":{
              "rt":[
                "oic.wk.shadow.sync"
              ],
              "if":[
                "oic.if.rw",
                "oic.if.baseline"
              ],
              "n":"ShadowSync",
              "id":"0_ShadowSync"
            },
            "schema":{
              "$ref":"#/definitions/baseline"
            }
          }
        }
      },
      "delete":{
        "description":"The Original Device may issue a DELETE request to this resource on a Shadow Device to signal the Shadow Service to remove and free the Shadow Device.",
        "parameters":[
          {
            "$ref":"#/parameters/interface"
          }
        ],
        "responses":{
          "200":{
            "description":"This response indicates that the Shadow Device was successfully removed."
          }
        }
      },
      "post":{
        "description":"This resource receives an UPDATE request containing an array of representations of Resources that have recently undergone a change in state and need to be synchronized. It then internally echoes those changes to all corresponding Resources in its Device and returns a response containing an array of changed representations from those Resources.\nThe UPDATE request also includes the identity of the device that issued this request in the \"di\" property.",
        "parameters":[
          {
            "$ref":"#/parameters/interface"
          },
          {
            "name":"body",
            "in":"body",
            "required":true,
            "schema":{
              "$ref":"#/definitions/ShadowSynchronizationRequest"
            },
            "x-example":{
              "di":"20590fd0-a11b-4b95-af91-27c69f4a5824",
              "resources":[
                {
                  "href":"/temperature",
                  "rep":{
                    "temperature":25,
                    "units":"C"
                  }
                }
              ]
            }
          }
        ],
        "responses":{
          "200":{
            "description":"The response payload includes the array of the current (updated) representations of all Resources included in the Request.",
            "x-example":[
              {
                "href":"/temperature",
                "rep":{
                  "rt":[
                    "oic.r.temperature"
                  ],
                  "if":[
                    "oic.if.a",
                    "oic.if.s",
                    "oic.if.baseline"
                  ],
                  "temperature":25,
                  "units":"C"
                }
              }
            ],
            "schema":{
              "$ref":"#/definitions/ShadowSynchronizationResponse"
            }
          },
          "403":{
            "description":"In the event that one or more Resources could not be synchronized, the response payload includes the unchanged representation for that resource and returns an array of updated or unchanged representations of all Resources included in the Request.",
            "x-example":[
              {
                "href":"/temperature",
                "rep":{
                  "rt":[
                    "oic.r.temperature"
                  ],
                  "if":[
                    "oic.if.a",
                    "oic.if.s",
                    "oic.if.baseline"
                  ],
                  "temperature":20,
                  "units":"C"
                }
              }
            ],
            "schema":{
              "$ref":"#/definitions/ShadowSynchronizationResponse"
            }
          }
        }
      }
    }
  },
  "parameters":{
    "interface":{
      "in":"query",
      "name":"if",
      "type":"string",
      "enum":[
        "oic.if.rw",
        "oic.if.baseline"
      ]
    }
  },
  "definitions":{
    "baseline":{
      "properties":{
        "rt":{
          "description":"The Resource Type.",
          "items":{
            "enum":[
              "oic.wk.shadow.sync"
            ],
            "type":"string",
            "maxLength":64
          },
          "minItems":1,
          "uniqueItems":true,
          "readOnly":true,
          "type":"array"
        },
        "if":{
          "description":"The OCF Interface set supported by this Resource.",
          "items":{
            "enum":[
              "oic.if.rw",
              "oic.if.baseline"
            ],
            "type":"string",
            "maxLength":64
          },
          "minItems":2,
          "readOnly":true,
          "uniqueItems":true,
          "type":"array"
        },
        "n":{
          "$ref":"https://openconnectivityfoundation.github.io/core/schemas/oic.common.properties.core-schema.json#/definitions/n"
        },
        "id":{
          "$ref":"https://openconnectivityfoundation.github.io/core/schemas/oic.common.properties.core-schema.json#/definitions/id"
        }
      },
      "type":"object",
      "required":[
        "rt",
        "if"
      ]
    },
    "ShadowSynchronizationRequest":{
      "properties":{
        "di":{
          "description":"The identity (UUID) of the entity issuing a synchronization request.",
          "$ref":"#/definitions/uuid"
        },
        "resources":{
          "description":"The array of Resources to be synchronized with the Shadow Device.",
          "items":{
            "properties":{
              "href":{
                "description":"This target URI for a Resource specified as a Relative Reference.",
                "format":"uri",
                "maxLength":256,
                "type":"string"
              },
              "rep":{
                "description":"The current Resource representation.",
                "type":"object"
              }
            },
            "type":"object",
            "required":[
              "href",
              "rep"
            ]
          },
          "minItems":1,
          "uniqueItems":true,
          "type":"array"
        }
      },
      "type":"object",
      "required":[
        "di",
        "resources"
      ]
    },
    "ShadowSynchronizationResponse":{
      "items":{
        "properties":{
          "href":{
            "description":"This target URI for a Resource specified as a Relative Reference.",
            "format":"uri",
            "maxLength":256,
            "type":"string"
          },
          "rep":{
            "description":"The current Resource representation.",
            "type":"object"
          }
        },
        "type":"object",
        "required":[
          "href",
          "rep"
        ]
      },
      "minItems":1,
      "uniqueItems":true,
      "type":"array"
    },
    "uuid":{
      "description":"Format pattern according to IETF RFC 4122.",
      "pattern":"^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$",
      "type":"string"
    }
  }
}
